# =============================================================================
# STUDYBUDDY BACKEND ENVIRONMENT VARIABLES
# =============================================================================
# Copy this file to .env and update with your actual values
# DO NOT commit .env to version control
# =============================================================================

# -----------------------------------------------------------------------------
# Application Settings
# -----------------------------------------------------------------------------
APP_ENV=development  # development | staging | production
APP_NAME=StudyBuddy
APP_VERSION=0.1.0
DEBUG=true
LOG_LEVEL=INFO  # DEBUG | INFO | WARNING | ERROR | CRITICAL

# API Configuration
API_V1_PREFIX=/api/v1
BACKEND_CORS_ORIGINS=["http://localhost:3000","http://localhost:8000"]

# -----------------------------------------------------------------------------
# Database Configuration (PostgreSQL)
# -----------------------------------------------------------------------------
DATABASE_URL=postgresql+asyncpg://studybuddy:studybuddy_dev@localhost:5432/studybuddy
DATABASE_POOL_SIZE=5
DATABASE_MAX_OVERFLOW=10
DATABASE_POOL_TIMEOUT=30
DATABASE_POOL_RECYCLE=3600

# -----------------------------------------------------------------------------
# Redis Configuration
# -----------------------------------------------------------------------------
REDIS_URL=redis://localhost:6379/0
REDIS_MAX_CONNECTIONS=50
REDIS_SOCKET_TIMEOUT=5
REDIS_SOCKET_CONNECT_TIMEOUT=5

# Cache TTL (seconds)
CACHE_TTL_DEFAULT=300
CACHE_TTL_USER=600
CACHE_TTL_COMMUNITY=900

# -----------------------------------------------------------------------------
# Celery Configuration (Background Tasks)
# -----------------------------------------------------------------------------
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2
CELERY_TASK_ALWAYS_EAGER=false
CELERY_TASK_EAGER_PROPAGATES=true

# -----------------------------------------------------------------------------
# JWT & Authentication
# -----------------------------------------------------------------------------
# Generate with: openssl rand -hex 32
JWT_SECRET_KEY=your-super-secret-jwt-key-change-this-in-production
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=15
JWT_REFRESH_TOKEN_EXPIRE_DAYS=30

# Password Hashing
BCRYPT_ROUNDS=12

# -----------------------------------------------------------------------------
# Google OAuth 2.0
# -----------------------------------------------------------------------------
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
GOOGLE_REDIRECT_URI=http://localhost:8000/api/v1/auth/google/callback

# -----------------------------------------------------------------------------
# Email Configuration (SMTP)
# -----------------------------------------------------------------------------
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-specific-password
SMTP_FROM_EMAIL=noreply@studybuddy.com
SMTP_FROM_NAME=StudyBuddy
SMTP_TLS=true
SMTP_SSL=false

# Email Templates
EMAIL_VERIFICATION_EXPIRY_HOURS=24
EMAIL_TEMPLATES_DIR=app/infrastructure/email/templates

# -----------------------------------------------------------------------------
# File Storage
# -----------------------------------------------------------------------------
STORAGE_BACKEND=local  # local | s3

# Local Storage (Development)
LOCAL_STORAGE_PATH=./storage
LOCAL_STORAGE_BASE_URL=http://localhost:8000/storage

# S3-Compatible Storage (Production)
S3_ENDPOINT_URL=https://s3.amazonaws.com
S3_ACCESS_KEY_ID=your-s3-access-key
S3_SECRET_ACCESS_KEY=your-s3-secret-key
S3_BUCKET_NAME=studybuddy-prod
S3_REGION=us-east-1
S3_PUBLIC_URL=https://cdn.studybuddy.com

# Upload Limits
MAX_UPLOAD_SIZE_MB=10
ALLOWED_IMAGE_EXTENSIONS=jpg,jpeg,png,gif,webp
ALLOWED_FILE_EXTENSIONS=pdf,doc,docx,txt

# -----------------------------------------------------------------------------
# Rate Limiting
# -----------------------------------------------------------------------------
RATE_LIMIT_ENABLED=true
RATE_LIMIT_AUTHENTICATED_PER_MINUTE=100
RATE_LIMIT_UNAUTHENTICATED_PER_MINUTE=20
RATE_LIMIT_AUTH_ENDPOINTS_PER_MINUTE=5

# -----------------------------------------------------------------------------
# WebSocket Configuration
# -----------------------------------------------------------------------------
WEBSOCKET_MAX_CONNECTIONS=10000
WEBSOCKET_HEARTBEAT_INTERVAL=30
WEBSOCKET_MESSAGE_QUEUE_SIZE=100

# -----------------------------------------------------------------------------
# Monitoring & Observability
# -----------------------------------------------------------------------------
# Sentry (Error Tracking)
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1

# Prometheus (Metrics)
METRICS_ENABLED=true
METRICS_PATH=/health/metrics

# Logging
STRUCTURED_LOGGING=true
LOG_JSON_FORMAT=true
LOG_PII_REDACTION=true

# -----------------------------------------------------------------------------
# Security Settings
# -----------------------------------------------------------------------------
# Generate with: openssl rand -hex 32
SECRET_KEY=your-super-secret-key-change-this-in-production

# CORS
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=["GET","POST","PATCH","PUT","DELETE","OPTIONS"]
CORS_ALLOW_HEADERS=["*"]

# Content Security Policy
CSP_ENABLED=true
CSP_REPORT_URI=/api/v1/security/csp-report

# -----------------------------------------------------------------------------
# Feature Flags
# -----------------------------------------------------------------------------
FEATURE_ANALYTICS_ENABLED=true
FEATURE_PREMIUM_TIER_ENABLED=false
FEATURE_WEBSOCKET_ENABLED=true
FEATURE_EMAIL_NOTIFICATIONS=true

# -----------------------------------------------------------------------------
# Testing (Test Environment Only)
# -----------------------------------------------------------------------------
TEST_DATABASE_URL=postgresql+asyncpg://studybuddy:studybuddy_test@localhost:5432/studybuddy_test
TEST_REDIS_URL=redis://localhost:6379/15
TEST_SKIP_MIGRATIONS=false

# -----------------------------------------------------------------------------
# Development Tools
# -----------------------------------------------------------------------------
RELOAD=true  # Auto-reload on code changes (development only)
HOT_RELOAD=true

# API Documentation
DOCS_ENABLED=true  # Disable in production
OPENAPI_URL=/api/v1/openapi.json
DOCS_URL=/docs
REDOC_URL=/redoc

apiVersion: v1
kind: ConfigMap
metadata:
  name: studybuddy-config
  labels:
    app: studybuddy
data:
  # Application Settings
  ENVIRONMENT: "production"
  DEBUG: "false"
  LOG_LEVEL: "INFO"

  # API Configuration
  API_V1_PREFIX: "/api/v1"
  ALLOWED_HOSTS: "api.studybuddy.example.com,*.studybuddy.example.com"

  # CORS Settings
  CORS_ORIGINS: "https://studybuddy.example.com,https://app.studybuddy.example.com"
  CORS_ALLOW_CREDENTIALS: "true"
  CORS_ALLOW_METHODS: "GET,POST,PUT,PATCH,DELETE,OPTIONS"
  CORS_ALLOW_HEADERS: "Content-Type,Authorization,X-Requested-With"

  # JWT Settings
  JWT_ALGORITHM: "HS256"
  ACCESS_TOKEN_EXPIRE_MINUTES: "15"
  REFRESH_TOKEN_EXPIRE_DAYS: "30"

  # OAuth Settings
  GOOGLE_REDIRECT_URI: "https://api.studybuddy.example.com/api/v1/auth/google/callback"

  # Email Settings
  SMTP_HOST: "smtp.gmail.com"
  SMTP_PORT: "587"
  SMTP_USE_TLS: "true"
  EMAIL_FROM: "noreply@studybuddy.example.com"
  EMAIL_FROM_NAME: "StudyBuddy"

  # Storage Settings
  STORAGE_TYPE: "s3"
  AWS_REGION: "us-west-2"
  AWS_S3_BUCKET: "studybuddy-uploads"
  UPLOAD_MAX_SIZE: "10485760"
  ALLOWED_EXTENSIONS: "jpg,jpeg,png,gif,pdf,doc,docx,txt"

  # Rate Limiting
  RATE_LIMIT_PER_MINUTE: "100"
  AUTH_RATE_LIMIT_PER_MINUTE: "5"
  UNAUTHENTICATED_RATE_LIMIT_PER_MINUTE: "20"

  # WebSocket
  WS_MAX_CONNECTIONS: "10000"
  WS_MESSAGE_MAX_SIZE: "1048576"
  WS_PING_INTERVAL: "30"
  WS_PING_TIMEOUT: "10"

  # Celery Settings
  CELERY_BROKER_URL_TEMPLATE: "redis://studybuddy-redis:6379/0"
  CELERY_RESULT_BACKEND_TEMPLATE: "redis://studybuddy-redis:6379/0"
  CELERY_TASK_ALWAYS_EAGER: "false"
  CELERY_TASK_SERIALIZER: "json"
  CELERY_RESULT_SERIALIZER: "json"
  CELERY_ACCEPT_CONTENT: "json"
  CELERY_TIMEZONE: "UTC"
  CELERY_BEAT_SCHEDULE_FILE: "/tmp/celerybeat-schedule"

  # Monitoring
  SENTRY_ENVIRONMENT: "production"
  SENTRY_TRACES_SAMPLE_RATE: "0.1"
  PROMETHEUS_METRICS_ENABLED: "true"

  # Feature Flags
  ENABLE_EMAIL_VERIFICATION: "true"
  ENABLE_GOOGLE_OAUTH: "true"
  ENABLE_ANALYTICS: "true"
  ENABLE_NOTIFICATIONS: "true"

  # Cache Settings
  CACHE_TTL: "300"
  SESSION_TTL: "86400"

  # Database Connection Pool
  DB_POOL_SIZE: "20"
  DB_MAX_OVERFLOW: "10"
  DB_POOL_TIMEOUT: "30"
  DB_POOL_RECYCLE: "3600"

  # Testing (only for staging)
  TESTING: "false"
  TEST_DATABASE_URL: ""
